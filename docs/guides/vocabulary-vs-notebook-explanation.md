# 単語 vs 単語帳の違い

## 📚 簡単に言うと

- **単語（words）** = 辞書・データベース（全ユーザー共通の3800語）
- **単語帳（notebook）** = ユーザーが自分の学習のために選んだ単語のリスト（個人用）

---

## 🔍 詳しく説明

### 1. 単語（wordsテーブル）

**全ユーザー共通の単語マスターデータベース**

```
words テーブル（全ユーザー共通）
├─ word_id: 1, word: "abandon", jp: "捨てる", level: 1
├─ word_id: 2, word: "ability", jp: "能力", level: 1
├─ word_id: 3, word: "able", jp: "できる", level: 1
├─ word_id: 4, word: "abolish", jp: "廃止する", level: 2
└─ ... (NGSLの3800語すべて)
```

**特徴:**
- ✅ 全ユーザーが同じデータを共有
- ✅ NGSLの3800語が入っている
- ✅ 1つの単語 = 1つのレコード（辞書のように）
- ✅ ユーザーが追加・削除できない（システム管理者が管理）

**現在の使い方:**
- 「10問テスト」→ wordsからランダムに10語選ぶ
- 「前々回テスト」→ wordsから以前学習した単語を選ぶ
- 「苦手テスト」→ wordsから間違えた単語を選ぶ

---

### 2. 単語帳（vocabulary_notebooks + notebook_words）

**ユーザーが自分で作る「学習用単語リスト」**

```
ユーザーAの単語帳
├─ 「今週覚える単語」単語帳
│   ├─ abandon (word_id: 1)
│   ├─ ability (word_id: 2)
│   └─ abolish (word_id: 4)
│
└─ 「苦手単語帳」（自動）
    ├─ abandon (word_id: 1) ← 3回間違えた
    └─ abolish (word_id: 4) ← 5回間違えた

ユーザーBの単語帳
└─ 「今週覚える単語」単語帳
    ├─ able (word_id: 3)
    └─ abandon (word_id: 1)
```

**特徴:**
- ✅ ユーザーごとに異なる（個人用）
- ✅ ユーザーが自由に作成・編集できる
- ✅ wordsテーブルから単語を選んで追加する
- ✅ 複数の単語帳を作れる（例: 「今週覚える単語」「苦手単語」「試験対策」）

**使い方:**
- 「今週覚える単語」単語帳を作る
- wordsから必要な単語を選んで追加
- その単語帳から学習する

---

## 📊 具体例で理解する

### 例1: 現在のシステム（単語帳なし）

```
ユーザーA: [10問テスト] をクリック
→ wordsからランダムに10語選ばれる
→ abandon, ability, able, abolish, ...

ユーザーB: [10問テスト] をクリック
→ wordsからランダムに10語選ばれる
→ abandon, ability, able, abolish, ...（同じ単語が出る可能性）
```

**問題点:**
- ユーザーが「今日はこの10語だけ集中して覚えたい」と思っても、ランダムなので選べない
- 「今週覚える単語」リストがあっても、その単語だけを学習できない

---

### 例2: 単語帳機能を使う場合

```
ユーザーA: 
1. 「今週覚える単語」単語帳を作成
2. abandon, ability, abolish を追加
3. [単語帳から学習] → 「今週覚える単語」を選択
   → その3語から問題が出る ✅

ユーザーB:
1. 「試験対策」単語帳を作成
2. able, abolish を追加
3. [単語帳から学習] → 「試験対策」を選択
   → その2語から問題が出る ✅
```

**メリット:**
- ✅ ユーザーが選んだ単語だけを学習できる
- ✅ 学習計画に合わせて単語を管理できる
- ✅ 複数の単語帳で学習を分けられる

---

## 🗂️ データベース構造の違い

### words テーブル（単語マスター）

```sql
words (全ユーザー共通)
├─ word_id (主キー)
├─ word ("abandon")
├─ jp ("捨てる")
├─ level (1)
└─ ... (その他の情報)
```

**1つの単語 = 1つのレコード**
- 全ユーザーが同じ "abandon" を参照
- ユーザーごとに別々のレコードはない

---

### vocabulary_notebooks + notebook_words（単語帳）

```sql
vocabulary_notebooks (ユーザーごとの単語帳)
├─ notebook_id: 1, user_id: "userA", name: "今週覚える単語"
├─ notebook_id: 2, user_id: "userA", name: "苦手単語"
└─ notebook_id: 3, user_id: "userB", name: "試験対策"

notebook_words (単語帳と単語の関連)
├─ notebook_id: 1, word_id: 1  ← ユーザーAの「今週覚える単語」に "abandon" が入っている
├─ notebook_id: 1, word_id: 2  ← ユーザーAの「今週覚える単語」に "ability" が入っている
├─ notebook_id: 2, word_id: 1  ← ユーザーAの「苦手単語」に "abandon" が入っている
└─ notebook_id: 3, word_id: 3  ← ユーザーBの「試験対策」に "able" が入っている
```

**1つの単語帳 = 複数の単語を含む**
- ユーザーごとに異なる単語帳
- 同じ単語（"abandon"）が複数の単語帳に入ることがある

---

## 🔗 関係性

```
words (辞書・データベース)
  ↑
  │ 参照する
  │
notebook_words (ユーザーが選んだ単語)
  ↑
  │ 含まれる
  │
vocabulary_notebooks (単語帳)
```

**単語帳はwordsテーブルから単語を「選んで」作る**

---

## 💡 なぜ単語帳が必要？

### 現在の問題点

1. **学習計画が立てにくい**
   - 「今週はこの10語を覚えたい」と思っても、ランダムなので選べない

2. **同じ単語を繰り返し学習できない**
   - 「苦手な単語だけを集中的に学習したい」と思っても、システムが選んでくれる

3. **学習の管理ができない**
   - 「試験対策用の単語リスト」を作れない

### 単語帳機能があれば

1. **学習計画が立てられる**
   - 「今週覚える単語」単語帳を作って、そこから学習

2. **集中的な学習ができる**
   - 「苦手単語帳」を作って、そこから繰り返し学習

3. **学習を管理できる**
   - 複数の単語帳で学習を分けられる

---

## 📝 まとめ

| 項目 | 単語（words） | 単語帳（notebook） |
|------|--------------|-------------------|
| **種類** | 辞書・データベース | ユーザーが作るリスト |
| **共有** | 全ユーザー共通 | ユーザーごとに異なる |
| **編集** | 管理者のみ | ユーザーが自由に編集 |
| **データ量** | 約3800語（固定） | ユーザーが決める |
| **用途** | 単語のマスターデータ | 学習計画・管理 |
| **例** | NGSLの全単語 | 「今週覚える単語」「苦手単語」 |

**単語 = 図書館の本棚（全員が使える）**  
**単語帳 = あなたが選んだ本のリスト（個人用）**

---

## 🎯 実装イメージ

```python
# 現在: wordsからランダムに選ぶ
words = await conn.fetch("SELECT * FROM words ORDER BY random() LIMIT 10")

# 単語帳機能: 単語帳から選ぶ
words = await conn.fetch("""
    SELECT w.* FROM words w
    JOIN notebook_words nw ON w.word_id = nw.word_id
    WHERE nw.notebook_id = $1
    ORDER BY random()
    LIMIT 10
""", notebook_id)
```

同じ `words` テーブルから単語を取得するが、**どの単語を選ぶか**が変わる。
