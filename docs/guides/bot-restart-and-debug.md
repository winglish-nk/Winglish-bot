# Botの再起動とデバッグ手順

> Botが正常に動作しない場合の確認手順

---

## 🔍 現状の問題

### 症状
- `/notebook`コマンドが表示されない
- ログに「notebook」や「Cog 読み込み完了」が見つからない
- Botは動作しているが、新しい機能が使えない

### 考えられる原因
1. **新しいコードがデプロイされていない**
2. **Botが再起動されていない**
3. **Cogの読み込みでエラーが発生している**
4. **ログの検索範囲が不適切**

---

## ✅ 解決手順

### ステップ1: 検索フィルターを外す

1. Railwayのログ画面で、検索バーの「note」を削除
2. 「x」ボタンをクリックして検索をクリア
3. すべてのログを表示

---

### ステップ2: Botを強制再起動

1. RailwayダッシュボードでBotサービスを開く
2. 「**Settings**」タブを開く
3. 下の方に「**Restart**」ボタンがあるので、クリック
4. 再起動が完了するまで待つ（1-2分）

---

### ステップ3: 起動ログをリアルタイムで確認

1. 「**Logs**」タブに移動
2. 再起動後、すぐにログを確認
3. 以下のログが表示されるはずです：

```
✅ データベース初期化完了
✅ Cog 読み込み完了: cogs.onboarding
✅ Cog 読み込み完了: cogs.menu
✅ Cog 読み込み完了: cogs.vocab
✅ Cog 読み込み完了: cogs.notebook  ← これ！
✅ Cog 読み込み完了: cogs.svocm
✅ Cog 読み込み完了: cogs.reading
✅ Cog 読み込み完了: cogs.admin
✅ 永続 View 登録完了
✅ スラッシュコマンド同期完了（グローバル）
✅ Logged in as Winglish#1234
```

---

### ステップ4: エラーログを確認

もし以下のようなエラーが出ていたら、それが原因です：

```
❌ Cog 読み込み失敗: cogs.notebook - ...
```

エラーが出ている場合は、エラーメッセージの内容を確認してください。

---

## 🚨 まだ見つからない場合

### 可能性1: コードがデプロイされていない

**確認方法:**
- Railwayの「**Deployments**」タブを確認
- 最新のデプロイが成功しているか確認
- 最新のコミットがデプロイされているか確認

**解決方法:**
- 新しいコードをプッシュ（git push）
- Railwayが自動的にデプロイするか確認
- または手動でデプロイをトリガー

---

### 可能性2: Botが起動していない

**確認方法:**
- Railwayの「**Settings**」タブを開く
- サービスのステータスを確認
- 「Running」になっているか確認

**解決方法:**
- ステータスが「Stopped」や「Failed」の場合は、再起動
- エラーが出ている場合は、エラーメッセージを確認

---

### 可能性3: 環境変数が設定されていない

**確認方法:**
- Railwayの「**Variables**」タブを確認
- 必要な環境変数（`DISCORD_TOKEN`、`DATABASE_URL`など）が設定されているか確認

---

## 🎯 今すぐ試すこと（優先順位順）

### 1. 検索フィルターをクリア
- 検索バーの「note」を削除
- すべてのログを表示

### 2. Botを再起動
- Railwayで「Restart」ボタンをクリック
- 再起動を待つ

### 3. ログをリアルタイムで確認
- 再起動後、すぐにログを確認
- 「Cog 読み込み完了」や「notebook」を探す

### 4. 最新のコードがデプロイされているか確認
- GitHubで最新のコミットを確認
- Railwayの「Deployments」タブで最新のデプロイを確認

---

## 📋 確認チェックリスト

- [ ] 検索フィルターをクリアした
- [ ] Botを再起動した
- [ ] 再起動後のログを確認した
- [ ] 「Cog 読み込み完了: cogs.notebook」が表示されているか確認
- [ ] 「スラッシュコマンド同期完了」が表示されているか確認
- [ ] エラーログがないか確認
- [ ] 最新のコードがデプロイされているか確認

---

## 💡 それでも動かない場合

以下の情報を共有してください：

1. **Bot再起動後のログ**（特にエラーメッセージ）
2. **RailwayのDeploymentsタブ**のスクリーンショット
3. **環境変数の設定状況**

これらを確認して、問題を特定しましょう！

